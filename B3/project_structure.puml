@startuml
' Beekeeping Management System - Class Diagram

' Define skin parameters for better visualization
skinparam classAttributeIconSize 0
skinparam defaultFontName Arial
skinparam defaultFontSize 10

' Enumerations
enum UserRole {
    ADMIN
    EMPLOYEE
}

enum TaskStatus {
    PENDING
    COMPLETED
    OVERDUE
}

enum TaskType {
    INSPECT_HIVE
    FEED_HIVE
    ACQUIRE_QUEEN
    OTHER
}

' Main Classes
class User {
    -id: int
    -name: String
    -email: String
    -password: String
    -role: UserRole
    -managedHives: List<Hive>
    -assignedTasks: List<Task>
    +authenticate(password: String): boolean
    +addHive(hive: Hive): void
    +assignTask(task: Task): void
    +completeTask(task: Task): void
}

class Hive {
    -id: int
    -isHealthy: boolean
    -isNeedsAttention: boolean
    -isQueenless: boolean
    -honeyLevel: double
}

class Task {
    -id: int
    -description: String
    -status: TaskStatus
    -type: TaskType
    -hiveId: int
    -createdDate: LocalDate
    -dueDate: LocalDate
    -assignedUserId: int
    +isOverdue(): boolean
    +isAssigned(): boolean
}

class Report {
    -id: int
    -userId: int
    -userName: String
    -content: String
    -relatedHiveIds: List<Integer>
    -relatedTaskIds: List<Integer>
    -timestamp: String
}

class DataManager {
    -hives: Map<Integer, Hive>
    -tasks: Map<Integer, Task>
    -users: Map<Integer, User>
    -reports: Map<Integer, Report>
    -DATA_FILE: String
    -lock: ReentrantReadWriteLock
    -logger: ActivityLogger
    +getInstance(): DataManager [static]
    +saveDataToFile(): void
    +loadDataFromFile(): void
    +reloadDataFromFile(): void
    +getHives(): Map<Integer, Hive>
    +getTasks(): Map<Integer, Task>
    +getUsers(): Map<Integer, User>
    +getReports(): Map<Integer, Report>
    +getHive(id: int): Hive
    +getTask(id: int): Task
    +getUser(id: int): User
    +getUserByEmail(email: String): User
    +addHive(hive: Hive): void
    +addTask(task: Task): void
    +addUser(user: User): void
    +addReport(report: Report): void
    +removeUser(id: int): void
    +removeReport(id: int): void
    +updateHive(hive: Hive): void
    +updateTask(task: Task): void
    +updateUser(user: User): void
    +getNextReportId(): int
}

class LoginManager {
    -dataManager: DataManager
    -scanner: Scanner
    +showLoginMenu(): User
    -authenticateUser(email: String, password: String): User
}

class ProgramLoop {
    -dataManager: DataManager
    -scanner: Scanner
    -currentUser: User
    +run(): void
}

class AdminManager {
    -dataManager: DataManager
    -scanner: Scanner
    -adminUser: User
    -logger: ActivityLogger
    +showAdminMenu(): void
    -createNewUser(): void
    -viewAllUsers(): void
    -createNewTask(): void
    -assignTaskToUser(): void
    -viewAllTasks(): void
    -viewAllHives(): void
    -createNewHive(): void
    -editTask(): void
    -editHive(): void
    -viewMyTasks(): void
    -viewReports(): void
    -deleteReport(): void
}

class EmployeeManager {
    -dataManager: DataManager
    -scanner: Scanner
    -employeeUser: User
    -logger: ActivityLogger
    +showEmployeeMenu(): void
    -refreshEmployeeData(): void
    -viewMyTasks(): void
    -completeTask(): void
    -submitReport(): void
    -editHive(): void
}

class ActivityLogger {
    -LOG_FILE: String
    -instance: ActivityLogger
    -lock: ReentrantReadWriteLock
    -formatter: DateTimeFormatter
    +getInstance(): ActivityLogger [static]
    +logActivity(userId: int, userName: String, action: String): void
    +logSystemActivity(action: String): void
}

' Relationships
User --> UserRole
Task --> TaskStatus
Task --> TaskType

User --> "0..*" Hive : manages
User --> "0..*" Task : assigns
User --> DataManager : uses

Task --> Hive : assigned to

Report --> User : created by
Report --> "0..*" Hive : relates to
Report --> "0..*" Task : relates to

ProgramLoop --> DataManager : uses
ProgramLoop --> LoginManager : uses
ProgramLoop --> User : current
ProgramLoop --> AdminManager : creates
ProgramLoop --> EmployeeManager : creates

LoginManager --> DataManager : uses
LoginManager --> User : authenticates

AdminManager --> DataManager : uses
AdminManager --> User : manages
AdminManager --> Task : manages
AdminManager --> Hive : manages
AdminManager --> Report : manages
AdminManager --> ActivityLogger : logs

EmployeeManager --> DataManager : uses
EmployeeManager --> User : manages
EmployeeManager --> Task : completes
EmployeeManager --> Hive : edits
EmployeeManager --> Report : creates
EmployeeManager --> ActivityLogger : logs

DataManager --> Hive : stores
DataManager --> Task : stores
DataManager --> User : stores
DataManager --> Report : stores
DataManager --> ActivityLogger : uses

note right of DataManager
  Uses ConcurrentHashMap for storage
  Implements file locking for data persistence
  Uses serialization for data persistence
end note

note right of LoginManager
  Uses Thread for background data loading
end note

note right of ActivityLogger
  Thread-safe logging with file locking
  Logs both user and system activities
end note

@enduml